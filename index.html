
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ì‹œê³µë³´ê³ ì„œ ì‘ì„±</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
        label { display: block; margin-top: 10px; }
        textarea, input, select { width: 100%; padding: 8px; margin-top: 5px; }
        button { margin-top: 15px; padding: 10px; width: 100%; font-weight: bold; }
        .result { white-space: pre-wrap; background: #f4f4f4; padding: 10px; margin-top: 15px; }
    </style>
</head>
<body>
    <h2>ì‹œê³µë³´ê³ ì„œ ì‘ì„±</h2>

    <label>1. ì‹œê³µíŒ€ì›</label>
    <input type="text" id="teamMember">

    <label>2. ì‘ì—…ì‹œê°„</label>
    <input type="text" id="workTime">

    <label>3. ì§€ì—­</label>
    <input type="text" id="location">

    <label>4. ì•„íŒŒíŠ¸ëª…</label>
    <input type="text" id="apartment">

    <label>5. í‰ ìˆ˜</label>
    <input type="text" id="size">

    <label>6. ì‹ ì¶•ì—¬ë¶€</label>
    <input type="text" id="newOrNot">

    <label>7. ê²°ì œë°©ë²•</label>
    <input type="text" id="payment">

    <label>8. ìƒ‰ìƒ</label>
    <select id="color">
        <option value="ëª¨ë˜">ëª¨ë˜</option>
        <option value="ë§ˆë¸”">ë§ˆë¸”</option>
        <option value="ìš°ë“œ">ìš°ë“œ</option>
    </select>

    <label>9. íŒë§¤ê°¯ìˆ˜</label>
    <input type="text" id="quantity">

    <label>10. íŒë§¤ë¹„ìš©</label>
    <input type="text" id="price">

    <label>11. ë¯¸ê²°ì œê¸ˆì•¡</label>
    <input type="text" id="unpaid">

    <label>12. ì‹œê³µë²”ìœ„</label>
    <input type="text" id="scope">

    <label>13. ì˜ˆì•½ê¸ˆ í˜„ê¸ˆì˜ìˆ˜ì¦</label>
    <input type="text" id="receipt">

    <label>14. ê¸°íƒ€</label>
    <input type="text" id="extra">

    <button onclick="generateReport()">ğŸ“‹ ê²°ê³¼ ë³´ê¸°</button>
    <button onclick="copyResult()">ë³µì‚¬í•˜ê¸°</button>
    <button onclick="sendToSheet()">ì—‘ì…€ ì‹œíŠ¸ ì „ì†¡</button>

    <div class="result" id="resultArea"></div>

    <script>
        const endpoint = "https://script.google.com/macros/s/AKfycbxtxy3sgN6uoe5d3bckcmkq41oBryjoXul9MvvaBU6NI_hOfZdGReWtmaArDSCQS8Ba/exec";

        function generateReport() {
            const teamMember = document.getElementById("teamMember").value;
            const workTime = document.getElementById("workTime").value;
            const location = document.getElementById("location").value;
            const apartment = document.getElementById("apartment").value;
            const size = document.getElementById("size").value;
            const newOrNot = document.getElementById("newOrNot").value;
            const payment = document.getElementById("payment").value;
            const color = document.getElementById("color").value;
            const quantity = document.getElementById("quantity").value;
            const price = document.getElementById("price").value;
            const unpaid = document.getElementById("unpaid").value;
            const scope = document.getElementById("scope").value;
            const receipt = document.getElementById("receipt").value;
            const extra = document.getElementById("extra").value;

            const result = 
`ì‹œê³µ ë³´ê³ ì„œ
1. ì‹œê³µì¼ : ${new Date().toISOString().slice(0,10)}
2. ì‘ì—…ì‹œê°„ : ${workTime}
3. ê³ ê°ì •ë³´ : 
   1. ì§€ì—­ : ${location}
   2. ì•„íŒŒíŠ¸ëª… : ${apartment}
   3. í‰ ìˆ˜ : ${size}
   4. ì‹ ì¶•ì—¬ë¶€ : ${newOrNot}
4. ê²°ì œë°©ë²• : ${payment}
5. ìƒ‰ìƒ : ${color}
6. íŒë§¤ê°¯ìˆ˜ : ${quantity}
7. íŒë§¤ë¹„ìš© : ${price}
8. ë¯¸ê²°ì œ ê¸ˆì•¡ : ${unpaid}
9. ì‹œê³µë²”ìœ„ : ${scope}
10. ì˜ˆì•½ê¸ˆ í˜„ê¸ˆì˜ìˆ˜ì¦ : ${receipt}
11. ê¸°íƒ€ : ${extra}
12. ì‹œê³µíŒ€ì› : ${teamMember}`;

            document.getElementById("resultArea").innerText = result;
        }

        function copyResult() {
            const text = document.getElementById("resultArea").innerText;
            navigator.clipboard.writeText(text).then(() => alert("ë³µì‚¬ ì™„ë£Œ!"));
        }

        function sendToSheet() {
            const data = {
                teamMember: document.getElementById("teamMember").value,
                workTime: document.getElementById("workTime").value,
                location: document.getElementById("location").value,
                apartment: document.getElementById("apartment").value,
                size: document.getElementById("size").value,
                newOrNot: document.getElementById("newOrNot").value,
                payment: document.getElementById("payment").value,
                color: document.getElementById("color").value,
                quantity: document.getElementById("quantity").value,
                price: document.getElementById("price").value,
                unpaid: document.getElementById("unpaid").value,
                scope: document.getElementById("scope").value,
                receipt: document.getElementById("receipt").value,
                extra: document.getElementById("extra").value
            };

            fetch(endpoint, {
                method: "POST",
                body: JSON.stringify(data)
            })
            .then(res => res.text())
            .then(res => alert("ì—‘ì…€ ì‹œíŠ¸ ì „ì†¡ ì™„ë£Œ!"))
            .catch(err => alert("ì „ì†¡ ì‹¤íŒ¨: " + err));
        }
    </script>
</body>
</html>
