
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ì‹œê³µë³´ê³ ì„œ</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 500px; margin: auto; background: #f9f9f9; }
        label { font-weight: bold; display: block; margin-top: 10px; }
        input, select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; }
        button { padding: 10px 15px; margin-top: 15px; margin-right: 10px; border: none; border-radius: 5px; cursor: pointer; }
        .result-box { white-space: pre-line; background: #fff; padding: 15px; margin-top: 20px; border: 1px solid #ccc; border-radius: 5px; }
    </style>
</head>
<body>
    <h2>ì‹œê³µë³´ê³ ì„œ ì‘ì„±</h2>
    <label>1. ì‹œê³µíŒ€ì›</label><input id="team" />
    <label>2. ì‘ì—…ì‹œê°„</label><input id="time" />
    <label>3. ì§€ì—­</label><input id="region" />
    <label>4. ì•„íŒŒíŠ¸ëª…</label><input id="apt" />
    <label>5. í‰ìˆ˜</label><input id="size" />
    <label>6. ì‹ ì¶•ì—¬ë¶€</label><input id="new" />
    <label>7. ê²°ì œë°©ë²•</label><input id="pay" />
    <label>8. ìƒ‰ìƒ</label>
    <select id="color">
        <option value="ëª¨ë˜">ëª¨ë˜</option>
        <option value="ë§ˆë¸”">ë§ˆë¸”</option>
        <option value="ìš°ë“œ">ìš°ë“œ</option>
    </select>
    <label>9. íŒë§¤ê°¯ìˆ˜</label><input id="count" />
    <label>10. íŒë§¤ë¹„ìš©</label><input id="price" />
    <label>11. ë¯¸ê²°ì œê¸ˆì•¡</label><input id="remain" />
    <label>12. ì‹œê³µë²”ìœ„</label><input id="range" />
    <label>13. ì˜ˆì•½ê¸ˆ í˜„ê¸ˆì˜ìˆ˜ì¦</label><input id="receipt" />
    <label>14. ê¸°íƒ€</label><input id="memo" />

    <button onclick="generateReport()">ğŸ“ ê²°ê³¼ ë³´ê¸°</button>
    <button onclick="copyReport()">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
    <button onclick="sendToSheet()">ğŸ“¤ ì—‘ì…€ ì‹œíŠ¸ ì „ì†¡</button>

    <div class="result-box" id="result"></div>

    <script>
        function today() {
            const d = new Date();
            return d.toISOString().split('T')[0].replace(/-/g, '');
        }

        function collectData() {
            return {
                "ì‹œê³µíŒ€ì›": document.getElementById("team").value,
                "ì‹œê³µì¼": today(),
                "ì‘ì—…ì‹œê°„": document.getElementById("time").value,
                "ì§€ì—­": document.getElementById("region").value,
                "ì•„íŒŒíŠ¸ëª…": document.getElementById("apt").value,
                "í‰ìˆ˜": document.getElementById("size").value,
                "ì‹ ì¶•ì—¬ë¶€": document.getElementById("new").value,
                "ê²°ì œë°©ë²•": document.getElementById("pay").value,
                "ìƒ‰ìƒ": document.getElementById("color").value,
                "íŒë§¤ê°¯ìˆ˜": document.getElementById("count").value,
                "íŒë§¤ë¹„ìš©": document.getElementById("price").value,
                "ë¯¸ê²°ì œê¸ˆì•¡": document.getElementById("remain").value,
                "ì‹œê³µë²”ìœ„": document.getElementById("range").value,
                "ì˜ˆì•½ê¸ˆí˜„ê¸ˆì˜ìˆ˜ì¦": document.getElementById("receipt").value,
                "ê¸°íƒ€": document.getElementById("memo").value
            };
        }

        function generateReport() {
            const d = collectData();
            const result = 
`ì‹œê³µë³´ê³ ì„œ
1. ì‹œê³µì¼ : ${d["ì‹œê³µì¼"]}
2. ì‘ì—…ì‹œê°„ : ${d["ì‘ì—…ì‹œê°„"]}
3. ê³ ê°ì •ë³´ : 
    1. ì§€ì—­ : ${d["ì§€ì—­"]}
    2. ì•„íŒŒíŠ¸ëª… : ${d["ì•„íŒŒíŠ¸ëª…"]}
    3. í‰ ìˆ˜ : ${d["í‰ìˆ˜"]}
    4. ì‹ ì¶•ì—¬ë¶€ : ${d["ì‹ ì¶•ì—¬ë¶€"]}
4. ê²°ì œë°©ë²• : ${d["ê²°ì œë°©ë²•"]}
5. ìƒ‰ìƒ : ${d["ìƒ‰ìƒ"]}
6. íŒë§¤ê°¯ìˆ˜ : ${d["íŒë§¤ê°¯ìˆ˜"]}
7. íŒë§¤ë¹„ìš© : ${d["íŒë§¤ë¹„ìš©"]}
8. ë¯¸ê²°ì œ ê¸ˆì•¡ : ${d["ë¯¸ê²°ì œê¸ˆì•¡"]}
9. ì‹œê³µë²”ìœ„ : ${d["ì‹œê³µë²”ìœ„"]}
10. ì˜ˆì•½ê¸ˆ í˜„ê¸ˆì˜ìˆ˜ì¦ : ${d["ì˜ˆì•½ê¸ˆí˜„ê¸ˆì˜ìˆ˜ì¦"]}
11. ê¸°íƒ€ : ${d["ê¸°íƒ€"]}`;
            document.getElementById("result").innerText = result;
        }

        function copyReport() {
            const text = document.getElementById("result").innerText;
            if (text.trim()) {
                navigator.clipboard.writeText(text);
                alert("ë³µì‚¬ ì™„ë£Œ!");
            } else {
                alert("ë¨¼ì € ê²°ê³¼ë³´ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.");
            }
        }

        function sendToSheet() {
            const data = collectData();
            fetch("https://script.google.com/macros/s/AKfycbzMbSUnTQKwtsvKC55dR7Ch9dz3VVrWtitBMut4I1pOv1OlBje8wOA-4PqYv7g-4LjCFg/exec", {
                method: "POST",
                body: JSON.stringify(data),
                headers: { "Content-Type": "application/json" }
            })
            .then(res => res.text())
            .then(txt => alert("ì—‘ì…€ ì‹œíŠ¸ ì „ì†¡ ê²°ê³¼: " + txt));
        }
    </script>
</body>
</html>
