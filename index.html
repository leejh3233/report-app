
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>시공보고서 작성</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: sans-serif; padding: 20px; }
    label { display: block; margin-top: 20px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    button { margin-top: 20px; padding: 12px; width: 100%; font-weight: bold; border-radius: 5px; }
    pre { background: #f9f9f9; padding: 15px; margin-top: 30px; white-space: pre-wrap; border-radius: 5px; border: 1px solid #ddd; }
  </style>
</head>
<body>
  <h2>시공보고서 작성</h2>
  <form id="reportForm">
    <label>1. 시공팀원 <input type="text" name="시공팀원" required></label>
    <label>2. 시공일 <input type="date" name="시공일" required></label>
    <label>3. 작업시간 <input type="text" name="작업시간" required></label>
    <label>4. 지역 <input type="text" name="지역" required></label>
    <label>5. 아파트명 <input type="text" name="아파트명" required></label>
    <label>6. 평수 <input type="text" name="평수" required></label>
    <label>7. 신축여부 <input type="text" name="신축여부" required></label>
    <label>8. 결제방법 <input type="text" name="결제방법" required></label>
    <label>9. 색상
      <select name="색상">
        <option value="모던">모던</option>
        <option value="마블">마블</option>
        <option value="우드">우드</option>
      </select>
    </label>
    <label>10. 판매갯수 <input type="text" name="판매갯수" required></label>
    <label>11. 판매비용 <input type="text" name="판매비용" required></label>
    <label>12. 미결제금액 <input type="text" name="미결제금액"></label>
    <label>13. 시공범위 <input type="text" name="시공범위"></label>
    <label>14. 예약금현금영수증 <input type="text" name="예약금현금영수증"></label>
    <label>15. 기타 <textarea name="기타"></textarea></label>
    <button type="button" onclick="generateReport()">📋 보고서 생성</button>
    <button type="button" onclick="copyReport()">📎 카톡 보고서 복사</button>
    <button type="submit">📤 엑셀 시트 전송</button>
  </form>

  <h3>📝 생성된 보고서</h3>
  <pre id="reportOutput">아직 보고서가 없습니다.</pre>

  <script>
    let currentReportText = "";

    function generateReport() {
      const form = document.getElementById("reportForm");
      const data = {};
      [...form.elements].forEach((el) => {
        if (el.name) data[el.name] = el.value;
      });
      let text = "시공 보고서\n";
      let count = 1;
      Object.entries(data).forEach(([key, val]) => {
        text += `${count++}. ${key} : ${val}\n\n`;
      });
      document.getElementById("reportOutput").textContent = text;
      currentReportText = text;
    }

    function copyReport() {
      if (!currentReportText) generateReport();
      navigator.clipboard.writeText(currentReportText).then(() => {
        alert("카톡 보고서 복사 완료!");
      });
    }

    document.getElementById("reportForm").addEventListener("submit", function (e) {
      e.preventDefault();
      generateReport(); // 시트 전송 전에도 업데이트
      const form = e.target;
      const data = {};
      [...form.elements].forEach((el) => {
        if (el.name) data[el.name] = el.value;
      });
      fetch("https://script.google.com/macros/s/https://script.google.com/macros/s/https://script.google.com/macros/s/AKfycbyrOX1-5qDzqeldfkAvf3AunBevZ6KnPB8keq9WGhRnuFCiLy_e5exI0OheE2u-JuLvXw/exec/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });
      alert("엑셀 시트로 전송 완료!");
    });
  </script>
</body>
</html>
