
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì‹œê³µë³´ê³ ì„œ ì‘ì„±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: sans-serif; padding: 20px; }
    label { display: block; margin-top: 20px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    button { margin-top: 20px; padding: 12px; width: 100%; font-weight: bold; border-radius: 5px; }
    pre { background: #f9f9f9; padding: 15px; margin-top: 30px; white-space: pre-wrap; border-radius: 5px; border: 1px solid #ddd; }
  </style>
</head>
<body>
  <h2>ì‹œê³µë³´ê³ ì„œ ì‘ì„±</h2>
  <form id="reportForm">
    <label>1. ì‹œê³µíŒ€ì› <input type="text" name="ì‹œê³µíŒ€ì›" required></label>
    <label>2. ì‹œê³µì¼ <input type="date" name="ì‹œê³µì¼" required></label>
    <label>3. ì‘ì—…ì‹œê°„ <input type="text" name="ì‘ì—…ì‹œê°„" required></label>
    <label>4. ì§€ì—­ <input type="text" name="ì§€ì—­" required></label>
    <label>5. ì•„íŒŒíŠ¸ëª… <input type="text" name="ì•„íŒŒíŠ¸ëª…" required></label>
    <label>6. í‰ìˆ˜ <input type="text" name="í‰ìˆ˜" required></label>
    <label>7. ì‹ ì¶•ì—¬ë¶€ <input type="text" name="ì‹ ì¶•ì—¬ë¶€" required></label>
    <label>8. ê²°ì œë°©ë²• <input type="text" name="ê²°ì œë°©ë²•" required></label>
    <label>9. ìƒ‰ìƒ
      <select name="ìƒ‰ìƒ">
        <option value="ëª¨ë˜">ëª¨ë˜</option>
        <option value="ë§ˆë¸”">ë§ˆë¸”</option>
        <option value="ìš°ë“œ">ìš°ë“œ</option>
      </select>
    </label>
    <label>10. íŒë§¤ê°¯ìˆ˜ <input type="text" name="íŒë§¤ê°¯ìˆ˜" required></label>
    <label>11. íŒë§¤ë¹„ìš© <input type="text" name="íŒë§¤ë¹„ìš©" required></label>
    <label>12. ë¯¸ê²°ì œê¸ˆì•¡ <input type="text" name="ë¯¸ê²°ì œê¸ˆì•¡"></label>
    <label>13. ì‹œê³µë²”ìœ„ <input type="text" name="ì‹œê³µë²”ìœ„"></label>
    <label>14. ì˜ˆì•½ê¸ˆí˜„ê¸ˆì˜ìˆ˜ì¦ <input type="text" name="ì˜ˆì•½ê¸ˆí˜„ê¸ˆì˜ìˆ˜ì¦"></label>
    <label>15. ê¸°íƒ€ <textarea name="ê¸°íƒ€"></textarea></label>
    <button type="button" onclick="generateReport()">ğŸ“‹ ë³´ê³ ì„œ ìƒì„±</button>
    <button type="button" onclick="copyReport()">ğŸ“ ì¹´í†¡ ë³´ê³ ì„œ ë³µì‚¬</button>
    <button type="submit">ğŸ“¤ ì—‘ì…€ ì‹œíŠ¸ ì „ì†¡</button>
  </form>

  <h3>ğŸ“ ìƒì„±ëœ ë³´ê³ ì„œ</h3>
  <pre id="reportOutput">ì•„ì§ ë³´ê³ ì„œê°€ ì—†ìŠµë‹ˆë‹¤.</pre>

  <script>
    let currentReportText = "";

    function generateReport() {
      const form = document.getElementById("reportForm");
      const data = {};
      [...form.elements].forEach((el) => {
        if (el.name) data[el.name] = el.value;
      });
      let text = "ì‹œê³µ ë³´ê³ ì„œ\n";
      let count = 1;
      Object.entries(data).forEach(([key, val]) => {
        text += `${count++}. ${key} : ${val}\n\n`;
      });
      document.getElementById("reportOutput").textContent = text;
      currentReportText = text;
    }

    function copyReport() {
      if (!currentReportText) generateReport();
      navigator.clipboard.writeText(currentReportText).then(() => {
        alert("ì¹´í†¡ ë³´ê³ ì„œ ë³µì‚¬ ì™„ë£Œ!");
      });
    }

    document.getElementById("reportForm").addEventListener("submit", function (e) {
      e.preventDefault();
      generateReport(); // ì‹œíŠ¸ ì „ì†¡ ì „ì—ë„ ì—…ë°ì´íŠ¸
      const form = e.target;
      const data = {};
      [...form.elements].forEach((el) => {
        if (el.name) data[el.name] = el.value;
      });
      fetch("https://script.google.com/macros/s/https://script.google.com/macros/s/https://script.google.com/macros/s/AKfycbyrOX1-5qDzqeldfkAvf3AunBevZ6KnPB8keq9WGhRnuFCiLy_e5exI0OheE2u-JuLvXw/exec/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });
      alert("ì—‘ì…€ ì‹œíŠ¸ë¡œ ì „ì†¡ ì™„ë£Œ!");
    });
  </script>
</body>
</html>
